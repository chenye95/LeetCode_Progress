"""
You are assigned to put some amount of boxes onto one truck. You are given a 2D array boxTypes, where boxTypes[i] =
 [numberOfBoxesi, numberOfUnitsPerBoxi]:
    - numberOfBoxesi is the number of boxes of type i.
    - numberOfUnitsPerBoxi is the number of units in each box of the type i.

You are also given an integer truckSize, which is the maximum number of boxes that can be put on the truck. You can
 choose any boxes to put on the truck as long as the number of boxes does not exceed truckSize.

Return the maximum total number of units that can be put on the truck.
"""
from typing import List, Tuple


def max_units(box_types: List[Tuple[int, int]], truck_size: int) -> int:
    """
    :param box_types: list of (num_box_i, num_units_per_box_i) of 1 <= len(box_types) <= 1000, and
        1 <= num_box_i, num_units_per_box_i <= 1000
    :param truck_size: 1 <= truck_size <= 1e6
    :return: max number of units on the truck
    """
    box_types.sort(key=lambda box_type_i: box_type_i[1], reverse=True)
    total_units = 0
    for num_box_i, num_units_per_box_i in box_types:
        if num_box_i < truck_size:
            total_units += num_box_i * num_units_per_box_i
            truck_size -= num_box_i
        else:
            total_units += truck_size * num_units_per_box_i
            break
    return total_units


test_cases = [([(1, 3), (2, 2), (3, 1)], 4, 8),
              ([(5, 10), (2, 5), (4, 7), (3, 9)], 10, 91),
              ([(866, 148), (310, 222), (19, 854), (803, 429), (299, 719), (654, 426), (206, 396), (535, 459),
                (881, 518), (548, 1), (349, 5), (382, 838), (147, 129), (527, 934), (857, 995), (277, 241), (489, 279),
                (889, 707), (445, 322), (948, 791), (529, 788), (493, 12), (159, 80), (559, 122), (652, 652),
                (831, 330), (302, 534), (366, 908), (200, 354), (789, 45), (62, 616), (853, 724), (568, 960), (467, 54),
                (422, 778), (741, 883), (359, 21), (735, 823), (32, 850), (165, 599), (400, 861), (794, 856),
                (226, 262), (955, 666), (950, 822), (870, 850), (998, 128), (326, 936), (82, 354), (22, 937),
                (226, 388), (885, 300), (334, 91), (403, 783), (731, 490), (39, 345), (386, 662), (552, 515),
                (109, 672), (670, 917), (410, 641), (823, 429), (967, 641), (287, 101), (938, 191), (564, 245),
                (791, 845), (82, 676), (281, 703), (184, 636), (875, 862), (504, 550), (77, 391), (656, 276),
                (987, 829), (975, 247), (331, 761), (593, 313), (321, 860), (342, 137), (822, 299), (112, 140),
                (690, 664), (223, 642), (791, 948), (659, 358), (3, 796), (406, 816), (865, 356), (502, 142),
                (445, 376), (310, 441), (25, 639), (889, 817), (283, 910), (347, 330), (270, 934), (23, 698),
                (163, 196), (266, 585), (414, 977), (702, 200), (274, 835), (428, 64), (681, 797), (372, 886),
                (748, 370), (813, 580), (933, 145), (666, 812), (361, 858), (689, 623), (313, 742), (714, 785),
                (92, 243), (343, 261), (669, 78), (636, 126), (582, 249), (670, 291), (949, 496), (469, 31), (984, 607),
                (312, 23), (422, 761), (864, 757), (301, 949), (984, 582), (467, 42), (252, 928), (643, 204),
                (760, 413), (640, 843), (228, 282), (202, 355), (77, 242), (847, 698), (176, 811), (743, 489),
                (296, 774), (202, 933), (839, 586), (387, 670), (568, 911), (137, 864), (826, 66), (811, 302),
                (161, 358), (635, 942), (680, 679), (682, 831), (40, 278), (615, 505), (34, 68), (204, 557), (584, 988),
                (858, 230), (1000, 859), (268, 766), (836, 905), (97, 583), (390, 684), (235, 697), (716, 22),
                (648, 997), (877, 710), (505, 923), (770, 936), (674, 787), (376, 906), (505, 270), (731, 801),
                (906, 160), (119, 248), (887, 138), (763, 445), (881, 649), (620, 751), (697, 554), (885, 795),
                (8, 854), (336, 204), (43, 913), (110, 781), (571, 141), (762, 555), (972, 488), (957, 753), (404, 553),
                (562, 760), (70, 226), (273, 934), (10, 806), (504, 247), (990, 951), (44, 208), (176, 398), (554, 96),
                (52, 85), (629, 111), (475, 733), (784, 479), (258, 867), (689, 250), (63, 12), (629, 474), (347, 670),
                (294, 48), (389, 539), (792, 771), (922, 933), (173, 249), (449, 971), (76, 313), (751, 125),
                (547, 126), (279, 89), (889, 265), (810, 884), (323, 588), (889, 288), (661, 746), (85, 295),
                (860, 338), (316, 265), (149, 581), (280, 952), (331, 948), (803, 40), (573, 549), (168, 577),
                (631, 53), (433, 386), (635, 752), (919, 845), (990, 624), (806, 452), (14, 824), (551, 613),
                (941, 697), (118, 542), (778, 600), (163, 986), (276, 508), (66, 566), (43, 480), (662, 438),
                (727, 739), (215, 287), (569, 512), (236, 611), (708, 352), (530, 597), (942, 121), (545, 646),
                (627, 213), (177, 568), (30, 679), (134, 853), (597, 35), (465, 451), (920, 12), (349, 821), (77, 774),
                (288, 29), (754, 392), (827, 416), (297, 245), (21, 280), (544, 53), (114, 626), (649, 469), (515, 84),
                (659, 113), (854, 409), (877, 827), (88, 111), (56, 621), (884, 727), (491, 548), (799, 431),
                (121, 200), (292, 994), (56, 874), (51, 842), (940, 932), (143, 999), (612, 860), (844, 476),
                (392, 155), (628, 241), (379, 943), (531, 463), (21, 613), (437, 182), (621, 722), (795, 789),
                (880, 799), (880, 163), (40, 218), (79, 740), (97, 423), (624, 627), (270, 444), (300, 894), (445, 691),
                (494, 369), (710, 835), (674, 749), (9, 366), (482, 198), (753, 746), (617, 644), (828, 672), (808, 75),
                (940, 759), (557, 883), (433, 305), (654, 491), (262, 610), (980, 803), (959, 445), (358, 474),
                (833, 368), (257, 300), (741, 747), (340, 815), (373, 999), (52, 618), (611, 482), (969, 496),
                (152, 866), (648, 381), (624, 348), (782, 268), (67, 339), (607, 890), (646, 916), (22, 761),
                (694, 925), (279, 988), (105, 14), (605, 809), (142, 585), (626, 876), (633, 70), (968, 923),
                (529, 305), (32, 896), (559, 68), (192, 672), (411, 527), (713, 284), (991, 829), (191, 515), (169, 65),
                (648, 449), (66, 277), (416, 659), (284, 162), (978, 609), (857, 837), (391, 665), (291, 858),
                (76, 811), (535, 361), (362, 845), (432, 69), (869, 502), (398, 173), (717, 854), (719, 424),
                (910, 418), (872, 364), (250, 68), (312, 127), (903, 118), (768, 899), (551, 1000), (613, 288),
                (94, 296), (24, 812), (902, 40), (575, 645), (414, 761), (685, 427), (494, 61), (425, 923), (395, 541),
                (887, 21), (882, 799), (60, 787), (628, 444), (247, 899), (158, 869), (849, 793), (276, 686),
                (402, 576), (989, 676), (778, 948), (576, 797), (154, 686), (823, 799), (569, 48), (369, 897),
                (271, 648), (689, 217), (48, 333), (755, 460), (872, 755), (359, 427), (791, 698), (140, 572),
                (252, 90), (561, 307), (811, 479), (670, 599), (962, 219), (251, 884), (133, 69), (830, 455),
                (514, 141), (844, 921), (511, 808), (237, 133), (92, 857), (64, 211), (726, 454), (446, 627),
                (947, 489), (659, 857), (339, 395), (627, 273), (448, 287), (542, 687), (776, 77), (664, 848),
                (46, 363), (267, 606), (936, 228), (706, 55), (682, 71), (520, 442), (760, 147), (616, 513), (693, 383),
                (70, 91), (991, 807), (104, 819), (707, 466), (295, 948), (860, 965), (205, 247), (599, 771),
                (372, 547), (633, 326), (579, 766), (427, 977), (806, 3), (415, 894), (363, 696), (653, 151),
                (604, 420), (801, 125), (498, 441), (975, 299), (866, 742), (913, 108), (721, 252), (557, 320),
                (729, 798), (955, 511), (399, 34), (304, 20), (915, 867), (936, 669), (684, 779), (182, 918),
                (435, 298), (214, 153), (718, 944), (389, 695), (808, 320), (253, 709), (747, 166), (359, 55),
                (400, 744), (691, 977), (651, 455), (740, 419), (862, 941), (124, 329), (554, 555), (231, 256),
                (336, 761), (622, 764), (470, 220), (380, 509), (789, 531), (874, 231), (713, 515), (471, 630),
                (635, 333), (912, 34), (926, 757), (474, 556), (819, 833), (815, 404), (592, 465), (444, 890),
                (618, 123), (729, 984), (926, 21), (114, 431), (385, 562), (289, 659), (327, 157), (784, 421),
                (942, 330), (818, 421), (997, 353), (888, 606), (393, 663), (824, 762), (264, 901), (8, 241),
                (340, 876), (152, 304), (520, 578), (294, 552), (424, 149), (832, 334), (247, 909), (739, 419),
                (984, 340), (149, 666), (118, 518), (914, 403), (129, 591), (690, 237), (359, 351), (718, 823),
                (954, 289), (665, 345), (237, 650), (458, 667), (104, 352), (679, 409), (519, 211), (424, 712),
                (404, 882), (236, 20), (648, 929), (943, 85), (342, 196), (480, 638), (475, 667), (942, 552),
                (619, 676), (790, 562), (687, 847), (321, 589), (643, 132), (446, 910), (279, 189), (866, 9),
                (309, 299), (123, 361), (693, 696), (630, 248), (265, 353), (844, 685), (492, 61), (195, 671), (21, 89),
                (4, 415), (831, 187), (196, 230), (158, 600), (612, 704), (498, 427), (362, 860), (485, 350),
                (850, 172), (927, 51), (872, 844), (995, 603), (196, 897), (658, 431), (775, 934), (809, 614),
                (669, 335), (965, 881), (435, 91), (683, 698), (737, 146), (751, 976), (544, 534), (560, 271),
                (219, 184), (405, 867), (246, 21), (825, 699), (574, 207), (177, 731), (555, 725), (366, 573),
                (353, 523), (24, 151), (666, 382), (952, 75), (230, 809), (583, 769), (886, 1000), (699, 267),
                (341, 826), (631, 171), (392, 63), (637, 84), (161, 30), (72, 812), (438, 487), (342, 433), (524, 272),
                (12, 239), (516, 1), (919, 762), (984, 297), (78, 428), (751, 333), (22, 423), (235, 246), (374, 872),
                (692, 703), (936, 175), (688, 970), (422, 902), (239, 720), (521, 3), (555, 63), (920, 906), (116, 5),
                (235, 557), (739, 958), (149, 470), (683, 648), (797, 744), (147, 268), (873, 748), (431, 81),
                (628, 448), (939, 608), (838, 434), (874, 946), (516, 125), (980, 199), (712, 62), (291, 911),
                (943, 54), (432, 347), (524, 606), (751, 159), (424, 15), (999, 786), (743, 485), (785, 845),
                (871, 143), (714, 184), (860, 842), (295, 965), (288, 508), (768, 322), (714, 77), (38, 711),
                (732, 881), (563, 28), (580, 62), (35, 243), (925, 835), (599, 352), (653, 779), (335, 952), (886, 44),
                (676, 174), (844, 3), (30, 815), (945, 251), (715, 820), (838, 86), (620, 526), (103, 962), (522, 194),
                (45, 588), (315, 529), (981, 132), (544, 232), (581, 941), (603, 449), (217, 269), (158, 245),
                (407, 957), (200, 914), (186, 689), (618, 129), (276, 615), (974, 149), (341, 528), (448, 884),
                (940, 723), (673, 959), (762, 401), (615, 962), (919, 113), (323, 949), (429, 18), (406, 361),
                (292, 376), (582, 557), (801, 165), (311, 479), (141, 191), (376, 619), (671, 649), (729, 515),
                (59, 492), (309, 897), (123, 507), (98, 207), (538, 239), (655, 846), (366, 928), (273, 532),
                (798, 224), (508, 451), (105, 745), (166, 319), (434, 918), (230, 854), (12, 281), (598, 258),
                (312, 154), (636, 100), (263, 569), (490, 130), (237, 216), (483, 276), (674, 178), (908, 161),
                (409, 94), (476, 286), (825, 652), (90, 502), (863, 863), (623, 142), (776, 920), (180, 865),
                (888, 648), (404, 924), (680, 484), (365, 812), (116, 358), (442, 593), (776, 544), (406, 28),
                (341, 903), (902, 930), (734, 313), (566, 916), (415, 421), (744, 822), (98, 271), (458, 118),
                (416, 481), (525, 506), (656, 787), (464, 566), (313, 519), (580, 504), (545, 888), (664, 634),
                (870, 918), (498, 497), (458, 853), (394, 127), (317, 172), (561, 832), (118, 550), (339, 561),
                (614, 390), (843, 670), (938, 397), (361, 851), (418, 396), (378, 440), (750, 857), (841, 711),
                (720, 610), (540, 907), (612, 605), (980, 439), (23, 383), (776, 15), (996, 681), (517, 223),
                (218, 103), (531, 795), (708, 323), (89, 983), (799, 453), (290, 57), (555, 24), (846, 674), (898, 195),
                (955, 937), (790, 494), (349, 191), (770, 181), (489, 779), (137, 769), (564, 533), (593, 338),
                (659, 568), (1000, 511), (954, 331), (550, 883), (211, 607), (451, 675), (74, 495), (254, 454),
                (354, 361), (297, 828), (643, 373), (160, 783), (615, 761), (260, 611), (925, 502), (216, 37),
                (614, 30), (679, 790), (974, 307), (707, 895), (949, 74), (293, 458), (763, 200), (11, 495), (184, 718),
                (353, 990), (890, 398), (469, 47), (814, 626), (320, 418), (208, 503), (103, 608), (371, 356),
                (915, 77), (727, 594), (497, 720), (508, 840), (561, 375), (797, 355), (694, 277), (595, 480),
                (672, 448), (872, 560), (710, 567), (884, 953), (678, 828), (268, 409), (108, 996), (111, 475),
                (573, 56), (709, 554), (544, 218), (156, 980), (725, 825), (441, 474), (680, 735), (810, 722),
                (678, 328), (880, 809), (799, 354), (87, 382), (997, 453), (770, 531), (85, 535), (316, 131), (315, 45),
                (103, 256), (687, 59), (805, 637), (346, 112), (260, 206), (550, 238), (706, 81), (762, 616),
                (842, 940), (728, 519), (927, 989), (764, 491), (565, 660), (885, 468), (300, 471), (978, 75),
                (267, 949), (220, 853), (827, 564), (647, 373), (548, 799), (302, 821), (842, 12), (951, 720),
                (160, 745), (645, 607), (445, 446), (654, 879), (180, 82), (387, 433), (547, 939), (969, 159),
                (829, 101), (829, 534), (665, 231), (298, 155), (393, 403), (933, 432), (818, 112), (259, 846),
                (358, 25), (599, 218), (451, 589), (92, 714), (19, 737), (182, 969), (233, 537), (451, 859), (769, 377),
                (605, 311), (122, 283), (93, 635), (491, 204), (180, 755), (839, 227), (950, 226), (516, 517),
                (418, 996), (630, 667), (95, 950), (8, 395), (777, 502), (89, 261), (420, 61), (76, 9), (461, 841),
                (277, 94), (980, 347), (209, 442), (734, 744), (794, 142), (852, 73), (338, 887), (290, 296),
                (180, 916), (248, 345), (605, 999), (965, 632), (284, 741), (128, 800), (238, 212), (669, 494),
                (870, 182), (10, 503), (454, 959), (780, 297), (603, 62), (820, 241), (601, 737), (88, 569), (532, 835),
                (144, 771), (904, 554), (70, 256), (564, 990), (867, 363), (617, 106), (70, 293), (567, 647), (98, 77),
                (810, 877), (830, 767), (158, 329), (671, 778), (923, 10), (350, 954), (42, 544), (209, 890),
                (610, 181), (120, 130), (779, 694), (495, 984), (882, 907)],
               600022, 263761588),
              ]
for test_box_type, test_truck_size, expected_value in test_cases:
    assert max_units(test_box_type, test_truck_size) == expected_value
