"""
You are given an array of positive integers nums and want to erase a sub array containing unique elements. The score you
 get by erasing the sub array is equal to the sum of its elements.

Return the maximum score you can get by erasing exactly one sub array.

An array b is called to be a sub array of a if it forms a contiguous subsequence of a, that is, if it is equal to
 a[l], a[l+1], ..., a[r] for some (l, r).
"""
from typing import List


def max_unique_sub_array(nums: List[int]) -> int:
    """
    :param nums: 1 <= len(nums) <= 100000 and 1 <= nums[i] <= 10000
    :return: maximum sum you can get by erasing exactly one sub array.
    """
    max_value = 0
    window_start = 0
    window_sum = 0

    # ensure only unique values in sliding window
    window_values = set()

    # sliding window nums[window_start: window_end + 1]
    for num_window_end in nums:
        if num_window_end in window_values:
            max_value = max(max_value, window_sum)
            while nums[window_start] != num_window_end:
                window_sum -= nums[window_start]
                window_values.remove(nums[window_start])
                window_start += 1
            window_start += 1
        else:
            window_values.add(num_window_end)
            window_sum += num_window_end
            # since num_window_end is guaranteed to be positive, do NOT need to update max_value every time

    return max(max_value, window_sum)


test_cases = [([1, 2, 3, 4, 5, 6, 7, 8], 36),
              ([4, 2, 4, 5, 6], 17),
              ([5, 2, 1, 2, 5, 2, 1, 2, 5], 8),
              ([187, 470, 25, 436, 538, 809, 441, 167, 477, 110, 275, 133, 666, 345, 411, 459, 490, 266, 987, 965, 429,
                166, 809, 340, 467, 318, 125, 165, 809, 610, 31, 585, 970, 306, 42, 189, 169, 743, 78, 810, 70, 382,
                367, 490, 787, 670, 476, 278, 775, 673, 299, 19, 893, 817, 971, 458, 409, 886, 434], 16911),
              ([826, 164, 439, 310, 813, 633, 474, 248, 42, 455, 484, 195, 849, 279, 800, 708, 253, 410, 902, 391, 395,
                415, 172, 885, 695, 703, 531, 780, 904, 626, 811, 528, 546, 55, 206, 364, 358, 223, 669, 534, 160, 458,
                256, 730, 451, 906, 96, 748, 174, 611, 711, 138, 141, 554, 650, 900, 226, 140, 152, 571, 861, 83, 385,
                694, 671, 566, 60, 79, 768, 32, 692, 998, 24, 988, 793, 208, 337, 34, 744, 973, 260, 306, 511, 832, 199,
                823, 812, 8, 473, 652, 38, 987, 650, 613, 834, 477, 648, 528, 414, 972, 230, 168, 493, 762, 434, 385,
                42, 27, 284, 598, 969, 621, 320, 996, 564, 681, 568, 980, 860, 598, 285, 66, 645, 201, 821, 931, 261,
                448, 530, 926, 470, 924, 898, 816, 762, 883, 443, 61, 248, 444, 680, 816, 289, 675, 860, 143, 97, 655,
                243, 136, 850, 387, 899, 283, 975, 854, 22, 489, 647, 98, 94, 45, 287, 787, 955, 341, 807, 790, 222,
                828, 442, 854, 268, 111, 727, 158, 457, 548, 452, 218, 807, 535, 22, 203, 461, 497, 716, 46, 478, 423,
                145, 504, 852, 93, 273, 761, 236, 110, 370, 278, 127, 316, 595, 726, 11, 372, 166, 730, 404, 162, 456,
                184, 918, 111, 256, 220, 4, 40, 525, 738, 772, 25, 710, 160, 474, 449, 981, 776, 757, 139, 948, 712,
                928, 883, 90, 640, 884, 49, 179, 829, 167, 272, 961, 615, 526, 658, 58, 575, 291, 38, 707, 217, 601,
                897, 495, 378, 405, 948, 378, 787, 361, 955, 316, 537, 197, 343, 828, 264, 558, 197, 190, 361, 827, 263,
                166, 172, 194, 873, 292, 740, 870, 747, 262, 252, 386, 458, 623, 733, 802], 44739),
              ([4492, 7269, 7581, 5093, 7090, 5208, 6249, 974, 530, 7923, 280, 192, 6460, 5612, 737, 6718, 4983, 5311,
                6337, 3335, 9154, 7942, 7901, 9784, 7136, 8194, 8279, 8640, 3638, 6032, 2205, 5293, 6611, 4323, 9118,
                9486, 9040, 82, 6282, 1918, 4291, 4068, 328, 8853, 1584, 1090, 9438, 9164, 2017, 8471, 12, 1164, 3134,
                8184, 24, 254, 3045, 7094, 6659, 4112, 852, 5012, 8954, 1752, 9369, 5454, 9013, 6105, 8248, 9016, 8560,
                5460, 8440, 816, 4621, 2453, 6591, 8718, 4811, 2573, 1262, 5147, 1281, 8279, 9456, 9033, 8907, 3836,
                9904, 9555, 2727, 1777, 5335, 2413, 3673, 2317, 3210, 3846, 7561, 4621, 5486, 6946, 1027, 5783, 9511,
                6922, 8150, 2564, 5266, 8957, 6223, 7884, 5673, 3747, 118, 3036, 6058, 7306, 3210, 1820, 6163, 3048,
                5732, 3019, 1843, 8637, 6742, 4783, 594, 2077, 1518, 8531, 1973, 5630, 3850, 7318, 5466, 4949, 6548,
                7661, 5633, 499, 2828, 5472, 4703, 6597, 7309, 6611, 3113, 2344, 4074, 864, 4148, 7851, 3416, 67, 1024,
                4228, 5260, 6232, 6790, 8087, 9678, 9958, 1615, 326, 3925, 7524, 6903, 1100, 6199, 5047, 1799, 7018,
                6997, 4479, 7031, 9812, 3464, 5012, 5147, 495, 6587, 8444, 2242, 5792, 8681, 9076, 2995, 3809, 424,
                6917, 4421, 6109, 954, 3673, 5880, 8282, 1870, 7592, 3080, 9285, 4847, 5294, 5544, 2669, 8873, 9059,
                592, 4882, 8054, 8122, 6696, 3768, 920, 3944, 105, 9866, 4023, 8765, 6250, 2379, 4644, 409, 7530, 3053,
                5891, 2537, 349, 3515, 1714, 3742, 6415, 7286, 5070, 5106, 1611, 1792, 1622, 1154, 7098, 2192, 6857,
                4812, 3704, 8934, 5899, 4577, 7606, 5020, 5006, 9623, 6945, 6084, 3516, 2408, 4651, 6129, 7084, 6440,
                1554, 8041, 5341, 9303, 8953, 5983, 635, 9760, 2011, 7547, 8273, 2605, 4864, 8498, 9935, 7562, 2490,
                2239, 3659, 257, 7603, 3473, 6081, 8049, 4329, 1092, 8810, 3609, 1287, 1230, 6802, 6593, 4652, 3512,
                9755, 143, 4165, 5259, 5189, 4071, 7325, 6992, 3702, 2317, 3239, 9715, 987, 6624, 8655, 3693, 5407,
                8980, 4177, 1468, 4767, 2863, 4038, 8045, 7966, 9107, 5694, 6961, 2608, 9399, 1890, 9007, 335, 7080,
                5401, 7502, 9208, 4126, 9416, 7744, 2230, 3558, 9524, 8666, 2511, 331, 9911, 7943, 8772, 1236, 3584,
                433, 6210, 2530, 9024, 8441, 543, 5105, 1295, 7612, 3641, 9114, 9318, 2805, 7213, 7843, 5289, 9538,
                9305, 3213, 9982, 2813, 1205, 5243, 4704, 9798, 6975, 1476, 7805, 7902, 9123, 3897, 7659, 4250, 180,
                8116, 5905, 7073, 4792, 1289, 2595, 6494, 714, 613, 1304, 8441, 6440, 2491, 7968, 7500, 3140, 7867,
                6812, 3058, 1808, 1612, 7597, 9911, 7468, 4011, 6074, 9428, 9905, 8048, 965, 1458, 2327, 4905, 8080,
                8618, 8418, 3494, 5818, 4463, 9206, 5429, 4749, 6633, 713, 7587, 113, 1494, 3289, 4371, 7279, 9812,
                2046, 1287, 1551, 2788, 1091, 3082, 1535, 1710, 1964, 5858, 6010, 1351, 5888, 5258, 9254, 1910, 5218,
                1334, 7811, 546, 1621, 94, 1750, 9466, 6235, 8978, 4092, 5039, 607, 8284, 4467, 8092, 5138, 2481, 3306,
                3778, 1557, 7704, 7345, 272, 6787, 8419, 2423, 4615, 2648, 9467, 7837, 636, 7042, 7178, 9880, 2100, 70,
                5504, 565, 9417, 2178, 7333, 2936, 7106, 6956, 407, 1374, 6685, 3817, 4687, 2361, 5012, 103, 9197, 5085,
                2871, 1389, 2399, 3794, 2659, 1365, 994, 3861, 907, 3018, 3828, 5359, 7420, 1472, 6093, 1777, 2218,
                8343, 1741, 1805, 665, 7531, 5138, 2493, 5158, 5623, 4575, 4888, 2171, 6914, 8850, 3640, 2213, 7004,
                1853, 6514, 7635, 1742, 2037, 6131, 6878, 4870, 4231, 3608, 657, 9187, 9375, 2131, 7526, 9783, 5772,
                821, 4232, 1858, 9461, 3142, 5047, 6950, 9481, 4042, 524, 1198, 9144, 5355, 7323, 6622, 6203, 106, 7496,
                6010, 3290, 6550, 2043, 1978, 5507, 9789, 83, 4336, 6089, 8640, 2932, 1923, 8065, 5954, 1969, 6229,
                8287, 2691, 9451, 5710, 1543, 2642, 5447, 6965, 1, 6481, 1825, 8060, 4653, 5698, 2976, 3450, 4626, 6717,
                9321, 8892, 7756, 1868, 1287, 835, 25, 5435, 5416, 32, 7689, 1686, 5457, 7778, 5929, 4491, 1050, 2645,
                3497, 5827, 3645, 1505, 8494, 6578, 9943, 7533, 4547, 4615, 4072, 596, 5194, 3576, 8622, 50, 993, 5916,
                4554, 5051, 2009, 3545, 5473, 8983, 8299, 7578, 4974, 4874, 2226, 6517, 5999, 3325, 3791, 4682, 3428,
                1228, 5774, 2353, 7727, 508, 5331, 2203, 281, 9786, 4304, 400, 4163, 6528, 1959, 8958, 2942, 6815, 7509,
                7361, 2614, 457, 437, 2990, 1648, 1995, 844, 6800, 1662, 6701, 2472, 8846, 8549, 2258, 6574, 5686, 6042,
                1627, 3517, 9333, 7522, 2541, 5570, 7394, 9100, 5061, 1659, 1313, 5672, 9538, 9662, 3014, 4146, 123,
                690, 6510, 5893, 1517, 8074, 497, 9372, 5107, 2797, 7395, 3027, 5303, 6923, 6309, 1009, 5853, 8927,
                4912, 8957, 1544, 7001, 1060, 8642, 4367, 2986, 2782, 2836, 1963, 7469, 7065, 7591, 4441, 1677, 6311,
                6777, 7738, 8228, 4273, 4072, 459, 9275, 7267, 8981, 8037, 5402, 579, 3724, 8316, 5053, 6185, 1032,
                1365, 8572, 5214, 9065, 6760, 1213, 9966, 917, 1983, 2031, 7265, 1541, 9791, 4926, 6610, 4743, 4817,
                5072, 3083, 6088, 6494, 8020, 3709, 7884, 774, 5057, 1470, 3292, 8502, 7780, 8897, 940, 9523, 4542,
                9914, 9331, 684, 2696, 704, 5619, 4372, 3035, 2181, 2095, 4389, 1310, 9673, 1806, 9727, 5176, 1662,
                7180, 3623, 8754, 6445, 2750, 4417, 1689, 2027, 904, 6122, 6919, 3864, 4970, 7115, 6580, 1813, 571, 814,
                1786, 5266, 457, 7227, 1854, 4441, 9468, 4967, 4315, 3795, 597, 1906, 218, 7789, 7026, 2953, 1290, 6662,
                2953, 3050, 8047, 8967, 5552, 8806, 3676, 7808, 2777, 1751, 9036, 7060, 9003, 7496, 4008, 2070, 4394,
                9066, 761, 4251, 6511, 9341, 3375, 8528, 5100, 9352, 7454, 5157, 2067, 423, 8780, 1362, 8606, 8453,
                3992, 8520, 7284, 2230, 1419, 3484, 8017, 1643, 5145, 3028, 319, 9609, 1858, 7686, 9148, 4293, 151,
                8651, 1372, 1605, 745, 8798, 5986, 8187, 1220, 1150, 4949, 3542, 2855, 7754, 7037, 8461, 5302, 824,
                8660, 6750, 7868, 2184, 2977, 1585, 3690, 1709, 8430, 6463, 8446, 3161, 2024, 7775, 5897, 1310, 5880,
                7070, 4752, 9756, 7796, 4552, 9895, 9086, 8954, 3087, 4727, 3722, 2314, 8869, 8697, 769, 6427, 4037,
                853, 4091, 9272, 6396, 2048, 1475, 4246, 3240, 6558, 365, 3253, 1373, 6786, 92, 4581, 4266, 9414, 4653,
                3695, 4793, 1261, 3144, 6461, 8803, 2480, 3701, 9467, 8656, 3843, 7652, 8345, 9046, 4842, 4257, 9854,
                4778, 6935, 820, 2079, 5231, 8348, 4484, 9645, 5168, 1867, 2060, 930, 29, 9458, 6267, 4503, 3123, 8002,
                1722, 744, 763, 8946, 920, 6735, 3216, 3532, 1488, 4414, 7826, 6483, 6467, 2165, 3173, 8557, 5060, 3300,
                2736, 3070, 2205, 6881, 9469, 538, 6706, 851, 130, 5736, 7727, 6861, 3617, 8583, 5171, 2419, 8784, 3111,
                1532, 3714, 3641, 7122, 1246, 8937, 6209, 6129, 7009, 3970, 1403, 5559, 2620, 9459, 7983, 5269, 8616,
                2463, 782, 7865, 8035, 3547, 3470, 9704, 4735, 4819, 9188, 9535, 9457, 4389, 8982, 9514, 6798, 7247,
                7317, 5962, 9464, 3330, 1608, 9528, 8610, 8245, 5407, 6371, 8809, 4003, 8335, 2477, 8438, 3266, 7825,
                3819, 8742, 7314, 65, 1009, 7084, 1347, 8338, 5244, 4799, 3306, 2153, 5527, 3394, 2153, 1587, 3569,
                6182, 3285, 7236, 3480, 5550, 4121, 6757, 5393, 4877, 3870, 6315, 71, 383, 4628, 9066, 9289, 4675, 9225,
                24, 9874, 7577, 2231, 5675, 7281, 2685, 6779, 4139, 1734, 9489, 5311, 4919, 2918, 5339, 2523, 4431, 831,
                3694, 688, 5688, 778, 325, 6296, 320, 3253, 1264, 8736, 5732, 7263, 3867, 2191, 7286, 8308, 7173, 5920,
                31, 9201], 1497563), ]
for test_nums, expected_value in test_cases:
    assert max_unique_sub_array(test_nums) == expected_value
