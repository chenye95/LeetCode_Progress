"""
Given an array nums of integers, you can perform operations on the array.

In each operation, you pick any nums[i] and delete it to earn nums[i] points. After, you must delete every element equal
 to nums[i] - 1 or nums[i] + 1.

You start with 0 points. Return the maximum number of points you can earn by applying such operations.
"""
from collections import Counter
from typing import List


def delete_and_earn(nums: List[int]) -> int:
    """
    :param nums: 1 <= len(nums) <= 2e4 and 1 <= nums[i] <= 1e4
    :return: maximum number of points from delete and earn operations
    """
    x_count = Counter(nums)
    previous_k = None
    take_k = not_take_k = 0
    for k in sorted(x_count):
        if k - 1 != previous_k:
            not_take_k, take_k = max(not_take_k, take_k), k * x_count[k] + max(not_take_k, take_k)
        else:
            not_take_k, take_k = max(not_take_k, take_k), k * x_count[k] + not_take_k
        previous_k = k
    return max(not_take_k, take_k)


test_cases = [([5], 5),
              ([1, 1], 2),
              ([1, 2], 2),
              ([3, 4, 2], 6),
              ([2, 2, 3, 3, 3, 4], 9),
              ([10, 8, 4, 2, 1, 3, 4, 8, 2, 9, 10, 4, 8, 5, 9, 1, 5, 1, 6, 8, 1, 1, 6, 7, 8, 9, 1, 7, 6, 8, 4, 5, 4, 1,
                5, 9, 8, 6, 10, 6, 4, 3, 8, 4, 10, 8, 8, 10, 6, 4, 4, 4, 9, 6, 9, 10, 7, 1, 5, 3, 4, 4, 8, 1, 1, 2, 1,
                4, 1, 1, 4, 9, 4, 7, 1, 5, 1, 10, 3, 5, 10, 3, 10, 2, 1, 10, 4, 1, 1, 4, 1, 2, 10, 9, 7, 10, 1, 2, 7,
                5], 338),
              ([94, 27, 27, 27, 34, 82, 97, 93, 62, 10, 78, 25, 23, 41, 53, 16, 81, 93, 52, 53, 74, 78, 18, 27, 66, 62,
                40, 50, 8, 20, 31, 77, 26, 82, 28, 60, 98, 94, 26, 30, 23, 49, 54, 80, 69, 28, 25, 32, 78, 7, 1, 73, 2,
                31, 99, 78, 50, 95, 28, 53, 60, 78, 71, 52, 25, 85, 21, 16, 20, 78, 96, 96, 65, 1, 19, 18, 24, 18, 55,
                69, 88, 76, 14, 23, 58, 17, 83, 43, 63, 9, 41, 6, 71, 7, 2, 20, 21, 63, 18, 36, 53, 95, 36, 11, 32, 64,
                52, 48, 52, 11, 50, 48, 35, 49, 24, 89, 72, 33, 60, 57, 46, 3, 24, 90, 20, 95, 87, 8, 93, 1, 47, 2, 66,
                45, 57, 75, 18, 76, 96, 67, 65, 92, 92, 41, 57, 60, 98, 98, 10, 64, 23, 86, 100, 20, 21, 93, 49, 54, 77,
                77, 34, 98, 94, 4, 9, 75, 67, 4, 31, 82, 87, 26, 70, 26, 59, 86, 100, 22, 15, 61, 57, 73, 54, 54, 76,
                82, 56, 63, 49, 46, 53, 71, 32, 1, 64, 48, 20, 71, 2, 60, 83, 80, 97, 30, 2, 57, 31, 82, 21, 63, 52, 46,
                71, 55, 58, 94, 16, 9, 62, 67, 74, 79, 87, 31, 53, 27, 80, 11, 33, 52, 73, 2, 88, 80, 9, 38, 37, 3, 79,
                24, 89, 75, 10, 97, 24, 63, 24, 47, 80, 56, 75, 23, 32, 58, 72, 80, 95, 28, 57, 37, 17, 48, 14, 85, 58,
                61, 58, 1, 37, 14, 34, 76, 11, 63, 67, 7, 9, 8, 74, 38, 97, 56, 25, 67, 9, 34, 62, 58, 72, 77, 15, 15,
                90, 36, 60, 39, 95, 61, 28, 44, 43, 56, 22, 12, 81, 13, 10, 91, 84, 46, 39, 35, 39, 65, 82, 41, 51, 19,
                76, 99, 75, 88, 43, 89, 21, 83, 6, 35, 21, 47, 4, 21, 51, 76, 63, 43, 71, 39, 43, 16, 36, 78, 35, 68,
                75, 81, 91, 97, 7, 82, 44, 73, 56, 39, 76, 21, 76, 87, 98, 6, 38, 96, 84, 96, 77, 84, 83, 28, 52, 100,
                6, 52, 78, 7, 91, 96, 97, 62, 32, 26, 7, 80, 71, 25, 58, 23, 54, 74, 81, 4, 84, 35, 83, 58, 64, 42, 38,
                30, 88, 87, 52, 95, 23, 31, 31, 55, 7, 20, 18, 84, 40, 14, 93, 40, 45, 69, 84, 30, 66, 6, 88, 41, 88,
                98, 80, 69, 64, 1, 100, 48, 2, 89, 6, 21, 45, 73, 77, 31, 20, 70, 89, 30, 53, 33, 59, 8, 82, 63, 17, 10,
                46, 49, 86, 9, 14, 68, 6, 15, 55, 36, 71, 64, 80, 59, 40, 60, 46, 24, 49, 45, 78, 38, 92, 43, 99, 78, 5,
                83, 57, 76, 34, 11, 93, 71, 71, 54, 54, 29, 29, 74, 83, 72, 1, 6, 56, 22, 85, 35, 48, 29], 14251),
              ([91, 11, 1, 37, 79, 39, 94, 16, 16, 73, 48, 44, 52, 40, 96, 27, 15, 86, 20, 81, 99, 57, 10, 90, 46, 66,
                77, 52, 42, 74, 16, 45, 47, 4, 84, 41, 34, 54, 87, 53, 13, 69, 83, 88, 69, 63, 5, 97, 13, 65, 10, 46,
                17, 10, 62, 79, 62, 32, 13, 12, 57, 61, 100, 98, 43, 7, 24, 45, 8, 85, 88, 81, 58, 79, 41, 10, 63, 67,
                22, 37, 8, 27, 38, 37, 7, 53, 31, 68, 1, 37, 17, 16, 47, 100, 78, 13, 81, 37, 25, 11, 88, 55, 36, 24,
                32, 74, 78, 58, 95, 17, 66, 72, 13, 77, 26, 8, 10, 76, 51, 93, 7, 64, 89, 30, 1, 37, 4, 16, 32, 76, 98,
                9, 97, 10, 17, 78, 76, 25, 58, 20, 93, 45, 58, 16, 73, 55, 26, 68, 38, 49, 97, 71, 37, 14, 43, 42, 79,
                4, 82, 63, 20, 9, 12, 77, 83, 68, 24, 69, 21, 52, 21, 50, 63, 25, 92, 66, 72, 30, 70, 74, 84, 28, 69,
                89, 12, 31, 25, 58, 40, 60, 61, 80, 25, 78, 87, 2, 66, 33, 48, 63, 92, 80, 92, 1, 88, 32, 24, 19, 36,
                11, 25, 20, 58, 93, 65, 77, 6, 37, 32, 67, 93, 27, 21, 78, 5, 86, 8, 6, 13, 7, 72, 19, 95, 82, 70, 34,
                72, 82, 87, 63, 1, 20, 42, 80, 10, 86, 80, 83, 81, 57, 20, 95, 87, 60, 23, 64, 84, 31, 29, 51, 100, 66,
                98, 40, 84, 14, 54, 93, 25, 54, 14, 96, 12, 21, 70, 44, 69, 68, 52, 11, 16, 65, 92, 50, 41, 88, 24, 45,
                39, 22, 68, 53, 53, 13, 57, 63, 52, 85, 1, 17, 28, 18, 21, 9, 11, 62, 91, 64, 91, 59, 5, 33, 43, 74, 11,
                12, 58, 54, 15, 73, 1, 8, 22, 39, 61, 82, 35, 38, 83, 42, 11, 34, 38, 5, 10, 92, 50, 61, 72, 37, 60, 50,
                76, 26, 88, 29, 81, 8, 56, 73, 8, 24, 98, 63, 13, 15, 39, 97, 20, 48, 64, 75, 59, 70, 33, 13, 68, 80,
                23, 67, 49, 55, 64, 85, 48, 80, 1, 38, 24, 21, 12, 56, 39, 46, 20, 10, 78, 44, 9, 93, 77, 50, 3, 53, 14,
                72, 75, 72, 5, 2, 87, 92, 1, 23, 16, 65, 58, 72, 14, 83, 78, 86, 51, 59, 71, 55, 10, 6, 11, 75, 92, 59,
                67, 78, 84, 72, 16, 34, 92, 59, 22, 45, 84, 19, 74, 86, 41, 85, 28, 62, 29, 7, 16, 74, 15, 32, 55, 13,
                33, 13, 40, 80, 13, 58, 19, 2, 48, 36, 88, 26, 94, 60, 34, 54, 8, 8, 53, 94, 91, 70, 34, 36, 24, 77, 62,
                19, 16, 50, 80, 33, 3, 89, 36, 57, 6, 23, 35, 47, 5, 76, 94, 21, 49, 99, 88, 47, 98, 68, 21, 40, 74,
                100, 17, 6, 57, 65, 35, 1, 18, 62, 57, 1, 30, 100, 5, 89, 28, 61, 97, 35, 83, 54, 49, 2, 5, 41, 37, 51,
                23, 85, 82, 20, 73, 2, 91, 44, 70, 75, 80, 9, 86, 86, 23, 12, 79, 88, 3, 76, 22, 83, 17, 94, 71, 61, 82,
                76, 13, 64, 52, 29, 49, 88, 58, 90, 91, 6, 90, 6, 90, 86, 68, 37, 6, 24, 60, 37, 89, 35, 52, 33, 67, 89,
                36, 16, 70, 98, 88, 87, 91, 91, 70, 53, 97, 56, 2, 1, 91, 35, 95, 1, 75, 89, 87, 26, 54, 92, 69, 76, 21,
                82, 100, 86, 96, 20, 52, 96, 40, 96, 70, 46, 99, 95, 80, 48, 44, 97, 27, 64, 46, 27, 72, 20, 86, 20, 81,
                80, 35, 27, 48, 59, 25, 97, 74, 99, 92, 54, 40, 1, 31, 7, 61, 29, 39, 1, 11, 29, 59, 88, 95, 53, 81, 57,
                99, 16, 56, 23, 44, 60, 50, 29, 1, 71, 66, 93, 90, 67, 93, 53, 58, 25, 91, 88, 6, 32, 90, 57, 39, 91,
                51, 68, 97, 92, 45, 17, 34, 59, 63, 67, 20, 33, 3, 19, 78, 82, 94, 90, 48, 72, 50, 48, 42, 66, 80, 15,
                100, 61, 67, 28, 72, 95, 18, 42, 96, 16, 98, 75, 52, 75, 47, 18, 80, 67, 80, 2, 98, 53, 38, 51, 71, 32,
                15, 69, 98, 92, 79, 14, 20, 30, 13, 4, 37, 99, 90, 87, 10, 44, 96, 100, 5, 76, 34, 5, 62, 64, 62, 23,
                52, 62, 43, 63, 89, 86, 4, 75, 19, 57, 97, 79, 12, 38, 37, 90, 61, 21, 78, 99, 19, 98, 81, 39, 36, 63,
                4, 41, 93, 77, 75, 27, 35, 65, 48, 44, 93, 77, 64, 69, 91, 17, 97, 54, 61, 58, 78, 59, 66, 95, 39, 31,
                14, 28, 12, 52, 47, 49, 83, 27, 72, 9, 79, 74, 6, 16, 43, 23, 91, 19, 85, 51, 45, 70, 11, 98, 3, 54, 61,
                43, 92, 57, 58, 37, 90, 27, 59, 58, 2, 41, 13, 68, 49, 14, 24, 33, 76, 37, 72, 98, 55, 42, 22, 38, 73,
                82, 47, 37, 33, 46, 92, 25, 70, 42, 82, 19, 84, 78, 94, 69, 9, 91, 21, 48, 7, 16, 42, 40, 36, 34, 95,
                17, 36, 71, 77, 97, 64, 41, 92, 92, 52, 90, 81, 86, 18, 18, 24, 3, 30, 9, 51, 68, 87, 33, 40, 89, 16,
                30, 93, 1, 5, 13, 8, 40, 78, 8, 86, 77, 15, 61, 23, 36, 10, 98, 94, 87, 77, 14, 64, 43, 2, 78, 72, 93,
                85, 96, 12, 94, 80, 78, 40, 20, 50, 41, 76, 56, 34, 35, 66, 83, 49, 22, 8, 68, 4, 45, 31, 79, 51, 52,
                96, 67, 96, 66, 59, 85, 15, 57, 11, 49, 44, 56, 63, 58, 45, 63, 87, 58, 86, 96, 58, 100, 78, 37],
               27882),
              ]
for test_nums, expected_value in test_cases:
    assert delete_and_earn(test_nums) == expected_value
